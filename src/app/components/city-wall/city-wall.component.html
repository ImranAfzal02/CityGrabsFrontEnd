<app-header></app-header>
<i class="fa fa-2x fa-spinner fa-spin loaderSpinner" *ngIf="showLoader"></i>
<!-- SLIDER -->
<small class="color-red" style="margin-left: 10px;" *ngIf="showReloadMsg">
    Something went wrong. Please <a href="#" (click)="reload($event)">reload</a> this page.
</small>
<section class="weekly-deals mt-3 position-relative">
    <div class="container">
        <div class="wrapper">
            <div class="search-input">
                <a href="" target="_blank" hidden></a>

                <ng-autocomplete
                    #auto
                    [data]="searchableCategories"
                    [searchKeyword]="keyword"
                    (selected)='selectEvent($event)'
                    (inputChanged)='onChangeSearch($event)'
                    (inputFocused)='onFocused($event)'
                    [itemTemplate]="itemTemplate"
                    [notFoundTemplate]="notFoundTemplate"
                    [(ngModel)]="this.searchableCategory"
                    placeholder="Search a business Category"
                >
                </ng-autocomplete>

                <ng-template #itemTemplate let-item>
                    <a [innerHTML]="item.name"></a>
                </ng-template>

                <ng-template #notFoundTemplate let-notFound>
                    <div [innerHTML]="notFound"></div>
                </ng-template>
            </div>
        </div>
        <h2>Select a weekly deal!</h2>
        <div class="mt-2">
            <owl-carousel-o [options]="customOptions">
                <ng-container *ngFor="let cat of categories">
                    <ng-template [width]="(cat.name.length*15)<=60?70:(cat.name.length*15)" carouselSlide [id] = "cat.id">
                        <div  class="item" (click)="filterAd(cat)">{{ cat.name }}</div>
                    </ng-template>
                </ng-container>
            </owl-carousel-o>
            <div class="jobs-links mt-1 d-flex align-items-center justify-content-center position-relative">
                <a href="javascript:;" class="" *ngFor="let cat of prominentCategories" (click)="filterAd(cat)" [title]="cat.name">{{ cat.name }}</a>
            </div>
        </div>
    </div>
</section>
<!-- END SLIDER -->

<!-- DEALS IMAGES -->
<div class="deals mt-2">
    <div class="container">
        <div class="deals-img">
            <ng-template ngFor let-advertisement [ngForOf]="advertisements">
                <div class="deals-img-icons position-relative">
                    <div class="img-icons d-flex align-items-center">
                        <div class="svg-icon" [hidden]="!advertisement.phone" (click)="initiateCall(advertisement)">
                            <svg class="icon icon-telephone" width="14" height="14">
                                <use href="assets/images/sprite.svg#telephone"></use>
                            </svg>
                        </div>
                        <div class="svg-icon" [hidden]="advertisement.popupImages.length === 0" data-bs-toggle="modal" data-bs-target="#popupImageModal" (click)="setPopUpImage(advertisement.popupImages)">
                            <svg class="icon icon-speaker" width="14" height="14">
                                <use href="assets/images/sprite.svg#speaker"></use>
                            </svg>
                        </div>
                    </div>
                </div>
                <img class="img-fluid" [src]="imageBaseUrl + '/' + advertisement.main_image" alt=" ">
                <hr class="dropdown-divider">
            </ng-template>
            <div *ngIf="advertisements.length == 0 && !showLoader">
                No advertisement found
            </div>
        </div>
    </div>
</div>
<!-- DEALS IMAGES -->

<!-- FOOTER -->
<footer class="footer text-center">
    <div class="footer-btn">
        <a href="javascript:;" title="nassau" [innerHTML]="city.name"></a>
    </div>
</footer>

<!-- MODAL 1 -->
<div class="modal fade" id="popupImageModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="modal-images" [ngClass]="(!first)?'mt-3':''" *ngFor="let img of this.popupImages; let first = first">
                    <img class="img-fluid full-width-img" [src]="imageBaseUrl + '/' + img.image_url" alt="">
                    <p [innerText]="img.description"></p>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- END MODAL 1 -->
